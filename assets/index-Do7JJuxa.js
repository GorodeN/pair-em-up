(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();class u{constructor(e,t=null){this.mode=e,this.grid=[],this.score=0,this.selectedCells=[],this.isChecking=!1,this.lastMove=null,this.revertAvailable=!1,this.gridColumns=9,this.maxRows=50,this.assistUses={hints:0,revert:0,addNumbers:0,shuffle:0,eraser:0},this.assistLimits={addNumbers:10,shuffle:5,eraser:5},t?this.loadState(t):this.initializeGrid()}loadState(e){this.grid=e.grid||[],this.score=e.score||0,this.selectedCells=e.selectedCells||[],this.lastMove=e.lastMove||null,this.revertAvailable=e.revertAvailable||!1,e.assistUses&&(this.assistUses={...this.assistUses,...e.assistUses})}initializeGrid(){switch(this.mode){case"classic":this.generateClassicGrid();break;case"random":this.generateRandomGrid();break;case"chaotic":this.generateChaoticGrid();break;default:this.generateClassicGrid()}}generateClassicGrid(){const e=[];for(let t=1;t<=9;t++)e.push(t);for(let t=11;t<=19;t++){const i=t.toString().split("").map(Number).filter(a=>a!==0);e.push(...i)}this.grid=e}generateRandomGrid(){const e=[];for(let t=1;t<=9;t++)e.push(t);for(let t=11;t<=19;t++){const i=t.toString().split("").map(Number).filter(a=>a!==0);e.push(...i)}this.shuffleArray(e),this.grid=e}generateChaoticGrid(){this.grid=Array.from({length:27},()=>Math.floor(Math.random()*9)+1)}shuffleArray(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}}isValidPair(e,t){return e===t||e+t===10}calculatePoints(e,t){return e===5&&t===5?3:e===t?1:e+t===10?2:0}selectCell(e){if(!this.isChecking)return this.selectedCells.includes(e)?(this.selectedCells=this.selectedCells.filter(t=>t!==e),{type:"deselect",index:e}):this.selectedCells.length===2?(this.selectedCells=[e],{type:"reset",newSelection:e}):(this.selectedCells.push(e),this.selectedCells.length===2?(this.lastMove={grid:[...this.grid],score:this.score},this.revertAvailable=!0,this.checkPair()):{type:"select",index:e})}canConnect(e,t){if(e===t)return!1;const s=Math.floor(e/this.gridColumns),i=e%this.gridColumns,a=Math.floor(t/this.gridColumns),n=t%this.gridColumns;return!!(this.areAdjacent(s,i,a,n)||s===a&&this.isClearHorizontally(s,i,n)||i===n&&this.isClearVertically(i,s,a)||this.areRowBoundariesConnected(s,a,e,t))}areAdjacent(e,t,s,i){const a=Math.abs(e-s),n=Math.abs(t-i);return a===1&&n===0||a===0&&n===1}isClearHorizontally(e,t,s){const i=Math.min(t,s),a=Math.max(t,s);for(let n=i+1;n<a;n++){const r=e*this.gridColumns+n;if(this.grid[r]!==null)return!1}return!0}isClearVertically(e,t,s){const i=Math.min(t,s),a=Math.max(t,s);for(let n=i+1;n<a;n++){const r=n*this.gridColumns+e;if(this.grid[r]!==null)return!1}return!0}areRowBoundariesConnected(e,t,s,i){if(Math.abs(e-t)!==1)return!1;const a=Math.min(e,t),n=Math.max(e,t);let r=-1;for(let l=this.gridColumns-1;l>=0;l--){const c=a*this.gridColumns+l;if(this.grid[c]!==null){r=c;break}}let o=-1;for(let l=0;l<this.gridColumns;l++){const c=n*this.gridColumns+l;if(this.grid[c]!==null){o=c;break}}return s===r&&e===a&&(i===o&&t===n)||i===r&&t===a&&(s===o&&e===n)}checkPair(){this.isChecking=!0;const[e,t]=this.selectedCells,s=this.grid[e],i=this.grid[t];if(this.isValidPair(s,i)&&this.canConnect(e,t)){const a=this.calculatePoints(s,i);return this.score+=a,this.grid[e]=null,this.grid[t]=null,this.selectedCells=[],this.isChecking=!1,{type:"valid",indices:[e,t],points:a,totalScore:this.score}}else return this.isChecking=!1,{type:"invalid",indices:[e,t]}}getGameState(){return{grid:[...this.grid],score:this.score,selectedCells:[...this.selectedCells],mode:this.mode,lastMove:this.lastMove?{grid:[...this.lastMove.grid],score:this.lastMove.score}:null,revertAvailable:this.revertAvailable,assistUses:{...this.assistUses}}}checkWinCondition(){return this.score>=100}checkLoseCondition(){const e=!this.hasValidPairs(),t=!this.hasAvailableAssists(),s=this.checkGridLimit();return e&&t||s}hasAvailableAssists(){const e=this.getAssistInfo();return e.addNumbers.available||e.shuffle.available||e.eraser.available}hasValidPairs(){const e=this.grid.map((t,s)=>t!==null?s:null).filter(t=>t!==null);for(let t=0;t<e.length;t++)for(let s=t+1;s<e.length;s++){const i=e[t],a=e[s],n=this.grid[i],r=this.grid[a];if(this.isValidPair(n,r)&&this.canConnect(i,a))return!0}return!1}countValidMoves(){let e=0;const t=this.grid.map((s,i)=>s!==null?i:null).filter(s=>s!==null);for(let s=0;s<t.length;s++)for(let i=s+1;i<t.length;i++){const a=t[s],n=t[i],r=this.grid[a],o=this.grid[n];this.isValidPair(r,o)&&this.canConnect(a,n)&&e++}return e}revert(){return this.revertAvailable&&this.lastMove?(this.grid=[...this.lastMove.grid],this.score=this.lastMove.score,this.selectedCells=[],this.revertAvailable=!1,this.assistUses.revert++,!0):!1}addNumbers(){if(this.assistUses.addNumbers>=this.assistLimits.addNumbers||Math.ceil(this.grid.length/this.gridColumns)>=this.maxRows)return!1;const t=this.maxRows*this.gridColumns-this.grid.length;if(t<=0)return!1;let s=[];switch(this.mode){case"classic":{s=[...this.grid.filter(a=>a!==null)];break}case"random":{s=[...this.grid.filter(a=>a!==null)],this.shuffleArray(s);break}case"chaotic":{const i=this.grid.filter(a=>a!==null).length;s=Array.from({length:i},()=>Math.floor(Math.random()*9)+1);break}}return s=s.slice(0,t),s.length===0?!1:(this.grid=[...this.grid,...s],this.assistUses.addNumbers++,!0)}checkGridLimit(){return Math.ceil(this.grid.length/this.gridColumns)>=this.maxRows}shuffle(){if(this.assistUses.shuffle>=this.assistLimits.shuffle)return!1;const e=this.grid.filter(s=>s!==null);this.shuffleArray(e);let t=0;return this.grid=this.grid.map(s=>s!==null?e[t++]:null),this.assistUses.shuffle++,!0}erase(e){return this.assistUses.eraser>=this.assistLimits.eraser?!1:this.grid[e]!==null?(this.grid[e]=null,this.assistUses.eraser++,!0):!1}getAssistInfo(){return{hints:{used:this.assistUses.hints,limit:1/0,available:!0},revert:{used:this.assistUses.revert,limit:1/0,available:this.revertAvailable},addNumbers:{used:this.assistUses.addNumbers,limit:this.assistLimits.addNumbers,available:this.assistUses.addNumbers<this.assistLimits.addNumbers},shuffle:{used:this.assistUses.shuffle,limit:this.assistLimits.shuffle,available:this.assistUses.shuffle<this.assistLimits.shuffle},eraser:{used:this.assistUses.eraser,limit:this.assistLimits.eraser,available:this.assistUses.eraser<this.assistLimits.eraser}}}}class g{constructor(){this.container=null,this.init()}init(){this.container=document.createElement("div"),this.container.className="notifications",document.body.appendChild(this.container)}show(e,t="info",s=3e3){const i=document.createElement("div");return i.className=`notification notification--${t}`,i.textContent=e,this.container.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},s),i}clear(){this.container.innerHTML=""}}class m{constructor(){this.sounds=new Map,this.enabled=!0,this.audioContext=null,this.notifications=new g,this.isUnlocked=!1,this.init()}init(){this.audioContext=null}ensureAudioContext(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch{return this.notifications.show("Web Audio API is not supported in this browser","warning"),this.enabled=!1,!1}return!0}async generateSound(e,t,s="sine",i=.1){if(!(!this.enabled||!this.isUnlocked)&&this.ensureAudioContext())try{this.audioContext.state==="suspended"&&await this.audioContext.resume();const a=this.audioContext.createOscillator(),n=this.audioContext.createGain();a.connect(n),n.connect(this.audioContext.destination),a.frequency.value=e,a.type=s,n.gain.setValueAtTime(0,this.audioContext.currentTime),n.gain.linearRampToValueAtTime(i,this.audioContext.currentTime+.01),n.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+t),a.start(this.audioContext.currentTime),a.stop(this.audioContext.currentTime+t)}catch(a){this.notifications.show(`Error generating sound: ${a}`,"warning")}}playSelect(){this.generateSound(800,.1,"sine",.1)}playDeselect(){this.generateSound(600,.1,"sine",.1)}playValidPair(){this.generateSound(1200,.3,"sine",.15),setTimeout(()=>{this.generateSound(1e3,.2,"sine",.1)},100)}playInvalidPair(){this.generateSound(150,.2,"sawtooth",.1)}playAssistUse(){this.generateSound(1e3,.2,"square",.1)}playWin(){this.generateSound(523.25,.2,"sine",.15),setTimeout(()=>{this.generateSound(659.25,.2,"sine",.15)},100),setTimeout(()=>{this.generateSound(783.99,.3,"sine",.15)},200)}playLose(){this.generateSound(200,.8,"sawtooth",.1),setTimeout(()=>{this.generateSound(150,.6,"sawtooth",.1)},400)}playGameStart(){this.generateSound(1e3,.1,"sine",.1),setTimeout(()=>{this.generateSound(1200,.1,"sine",.1)},100),setTimeout(()=>{this.generateSound(1400,.2,"sine",.1)},200)}playButtonClick(){this.generateSound(600,.1,"sine",.1)}setEnabled(e){this.enabled=e,e&&this.audioContext&&this.audioContext.state==="suspended"&&(this.audioContext.resume().catch(t=>{this.notifications.show(`Failed to resume audio context: ${t}`,"warning")}),this.audioContext.resume())}async unlock(){if(!(!this.enabled||this.isUnlocked)&&this.ensureAudioContext())try{const e=this.audioContext.createBuffer(1,1,22050),t=this.audioContext.createBufferSource();t.buffer=e,t.connect(this.audioContext.destination),this.audioContext.state==="suspended"&&await this.audioContext.resume(),t.start(0),t.stop(this.audioContext.currentTime+.001),this.isUnlocked=!0}catch(e){this.notifications.show(`Failed to unlock audio context: ${e}`,"warning")}}}class f{constructor(){this.screens={},this.currentScreen=null,this.gameLogic=null,this.timer=null,this.startTime=null,this.elapsedTime=0,this.notifications=new g,this.soundManager=new m,this.eraserMode=!1,this.gameResults=[],this.currentResultsTab="time",this.init()}init(){this.createScreens(),this.showScreen("start"),this.loadSettings(),this.loadGameResults(),this.checkSavedGame(),window.addEventListener("beforeunload",()=>{this.autoSaveGame()}),document.addEventListener("click",async()=>{await this.soundManager.unlock()},{once:!1})}createScreens(){this.createStartScreen(),this.createGameScreen(),this.createSettingsScreen(),this.createResultsScreen()}createStartScreen(){const e=document.createElement("div");e.className="start-screen",e.id="startScreen",e.innerHTML=`
      <h1 class="start-screen__title">Pair 'em Up</h1>
      <p class="start-screen__author">
        Created by <a href="https://github.com/GorodeN" target="_blank">@GorodeN</a>
      </p>
      <div class="start-screen__modes">
        <button class="start-screen__mode-button" data-mode="classic">Classic</button>
        <button class="start-screen__mode-button" data-mode="random">Random</button>
        <button class="start-screen__mode-button" data-mode="chaotic">Chaotic</button>
      </div>
      <button class="start-screen__continue-button" id="continueButton" disabled>Continue Game</button>
      <div class="start-screen__actions">
        <button class="start-screen__settings-button" id="settingsButton">Settings</button>
        <button class="start-screen__results-button" id="resultsButton">Results</button>
      </div>
    `,document.body.appendChild(e),this.screens.start=e,this.addStartScreenEventListeners()}createGameScreen(){const e=document.createElement("div");e.className="game-screen hidden",e.id="gameScreen",e.innerHTML=`
    <div class="game-screen__header">
      <div class="game-screen__info">
        <div class="game-screen__mode"><span id="currentMode">-</span></div>
        <div class="game-screen__score">Score: <span id="currentScore">0</span>/100</div>
        <div class="game-screen__timer">Time: <span id="gameTimer">00:00</span></div>
      </div>
      <div class="game-screen__controls">
        <button id="resetButton" title="Reset"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
</svg></button>
        <button id="saveButton" title="Save"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-save" viewBox="0 0 16 16">
  <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
</svg></button>
        <button id="gameSettingsButton" title="Settings"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
  <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
  <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
</svg></button>
        <button id="menuButton" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
  <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
</svg></button>
      </div>
    </div>
    
    <div class="game-screen__progress">
      <div class="progress-bar">
        <div class="progress-bar__fill" id="progressBar" style="width: 0%"></div>
      </div>
    </div>

    <div class="game-screen__grid" id="gameGrid">
      <div style="grid-column: 1 / -1; text-align: center; padding: 20px;">
        Select a game mode to start
      </div>
    </div>
    
    <div class="game-screen__assists">
      <button class="assist-button" data-assist="hints" id="hintsButton" title="Hints">
        <span class="assist-button__text"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
  <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
</svg></span>
        <span class="assist-button__counter" id="hintsCounter">∞</span>
      </button>
      <button class="assist-button" data-assist="revert" id="revertButton" title="Revert">
        <span class="assist-button__text"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-90deg-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M1.146 4.854a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H12.5A2.5 2.5 0 0 1 15 6.5v8a.5.5 0 0 1-1 0v-8A1.5 1.5 0 0 0 12.5 5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4z"/>
</svg></span>
        <span class="assist-button__counter" id="revertCounter">∞</span>
      </button>
      <button class="assist-button" data-assist="addNumbers" id="addNumbersButton" title="Add Numbers">
        <span class="assist-button__text"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
</svg></span>
        <span class="assist-button__counter" id="addNumbersCounter">10</span>
      </button>
      <button class="assist-button" data-assist="shuffle" id="shuffleButton" title="Shuffle">
        <span class="assist-button__text"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shuffle" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M0 3.5A.5.5 0 0 1 .5 3H1c2.202 0 3.827 1.24 4.874 2.418.49.552.865 1.102 1.126 1.532.26-.43.636-.98 1.126-1.532C9.173 4.24 10.798 3 13 3v1c-1.798 0-3.173 1.01-4.126 2.082A9.624 9.624 0 0 0 7.556 8a9.624 9.624 0 0 0 1.317 1.918C9.828 10.99 11.204 12 13 12v1c-2.202 0-3.827-1.24-4.874-2.418A10.595 10.595 0 0 1 7 9.05c-.26.43-.636.98-1.126 1.532C4.827 11.76 3.202 13 1 13H.5a.5.5 0 0 1 0-1H1c1.798 0 3.173-1.01 4.126-2.082A9.624 9.624 0 0 0 6.444 8a9.624 9.624 0 0 0-1.317-1.918C4.172 5.01 2.796 4 1 4H.5a.5.5 0 0 1-.5-.5z"/>
  <path d="M13 5.466V1.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192zm0 9v-3.932a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384l-2.36 1.966a.25.25 0 0 1-.41-.192z"/>
</svg></span>
        <span class="assist-button__counter" id="shuffleCounter">5</span>
      </button>
      <button class="assist-button" data-assist="eraser" id="eraserButton" title="Erase">
        <span class="assist-button__text"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eraser" viewBox="0 0 16 16">
  <path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828l6.879-6.879zm2.121.707a1 1 0 0 0-1.414 0L4.16 7.547l5.293 5.293 4.633-4.633a1 1 0 0 0 0-1.414l-3.879-3.879zM8.746 13.547 3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293l.16-.16z"/>
</svg></span>
        <span class="assist-button__counter" id="eraserCounter">5</span>
      </button>
    </div>
  `,document.body.appendChild(e),this.screens.game=e,this.addGameScreenEventListeners()}createSettingsScreen(){const e=document.createElement("div");e.className="settings-screen hidden",e.id="settingsScreen",e.innerHTML=`
      <div class="settings-screen__content">
        <h2 class="settings-screen__title">Settings</h2>
        
        <div class="settings-screen__section">
          <h3 class="settings-screen__section-title">Appearance</h3>
          
          <div class="settings-screen__option">
            <span class="settings-screen__option-label">Theme</span>
            <select class="settings-screen__select" id="themeSelect">
              <option value="light">Light</option>
              <option value="dark">Dark</option>
            </select>
          </div>
        </div>

        <div class="settings-screen__section">
          <h3 class="settings-screen__section-title">Sound</h3>
          
          <div class="settings-screen__option">
            <span class="settings-screen__option-label">Enable Sounds</span>
            <label class="settings-screen__toggle">
              <input type="checkbox" id="soundToggle">
              <span class="settings-screen__slider"></span>
            </label>
          </div>
        </div>

        <div class="settings-screen__section">
          <h3 class="settings-screen__section-title">Game</h3>
          
          <div class="settings-screen__option">
            <span class="settings-screen__option-label">Auto-save</span>
            <label class="settings-screen__toggle">
              <input type="checkbox" id="autoSaveToggle" checked>
              <span class="settings-screen__slider"></span>
            </label>
          </div>
        </div>

        <div class="settings-screen__buttons">
          <button class="settings-screen__button settings-screen__button--secondary" id="closeSettingsButton">
            Close
          </button>
          <button class="settings-screen__button settings-screen__button--primary" id="saveSettingsButton">
            Save Settings
          </button>
        </div>
      </div>
    `,document.body.appendChild(e),this.screens.settings=e,this.addSettingsScreenEventListeners()}createResultsScreen(){const e=document.createElement("div");e.className="results-screen hidden",e.id="resultsScreen",e.innerHTML=`
      <div class="results-screen__content">
        <h2 class="results-screen__title">Game Results</h2>
        
        <div class="results-screen__tabs">
          <button class="results-screen__tab results-screen__tab--active" data-tab="time">
            Best Time
          </button>
          <button class="results-screen__tab" data-tab="best">
            Best Scores
          </button>
        </div>

        <div id="resultsContent">
        </div>

        <div class="results-screen__buttons">
          <button class="results-screen__button results-screen__button--secondary" id="clearResultsButton">
            Clear History
          </button>
          <button class="results-screen__button results-screen__button--primary" id="closeResultsButton">
            Close
          </button>
        </div>
      </div>
    `,document.body.appendChild(e),this.screens.results=e,this.addResultsScreenEventListeners()}showScreen(e){Object.values(this.screens).forEach(t=>{t.id!=="settingsScreen"&&t.id!=="resultsScreen"&&t.classList.add("hidden")}),!(e==="settings"||e==="results")&&this.screens[e]&&(this.screens[e].classList.remove("hidden"),this.currentScreen=e)}showModal(e){this.screens[e]&&this.screens[e].classList.remove("hidden")}hideModal(e){this.screens[e]&&this.screens[e].classList.add("hidden")}addStartScreenEventListeners(){const e=this.screens.start;e.querySelectorAll(".start-screen__mode-button").forEach(n=>{n.addEventListener("click",r=>{const o=r.target.dataset.mode;this.soundManager.playButtonClick(),this.startNewGame(o)})}),e.querySelector("#continueButton").addEventListener("click",()=>{this.soundManager.playButtonClick(),this.continueGame()}),e.querySelector("#settingsButton").addEventListener("click",()=>{this.soundManager.playButtonClick(),this.showSettings()}),e.querySelector("#resultsButton").addEventListener("click",()=>{this.soundManager.playButtonClick(),this.showResults()})}addGameScreenEventListeners(){const e=this.screens.game;e.querySelector("#resetButton").addEventListener("click",()=>{this.soundManager.playButtonClick(),this.resetGame()}),e.querySelector("#saveButton").addEventListener("click",()=>{this.soundManager.playButtonClick(),this.saveGame()}),e.querySelector("#gameSettingsButton").addEventListener("click",()=>{this.soundManager.playButtonClick(),this.showSettings()}),e.querySelector("#menuButton").addEventListener("click",()=>{this.soundManager.playButtonClick(),this.returnToMenu()}),e.querySelectorAll(".assist-button").forEach(r=>{r.addEventListener("click",o=>{this.soundManager.playButtonClick();const h=o.target.closest(".assist-button").dataset.assist;this.useAssist(h)})})}addSettingsScreenEventListeners(){const e=this.screens.settings;e.querySelector("#closeSettingsButton").addEventListener("click",()=>{this.hideSettings()}),e.querySelector("#saveSettingsButton").addEventListener("click",()=>{this.saveSettings()}),e.addEventListener("click",i=>{i.target===e&&this.hideSettings()}),document.addEventListener("keydown",i=>{i.key==="Escape"&&!e.classList.contains("hidden")&&this.hideSettings()})}addResultsScreenEventListeners(){const e=this.screens.results;e.querySelector("#closeResultsButton").addEventListener("click",()=>{this.hideResults()}),e.querySelector("#clearResultsButton").addEventListener("click",()=>{this.clearGameResults()}),e.querySelectorAll(".results-screen__tab").forEach(a=>{a.addEventListener("click",n=>{const r=n.target.dataset.tab;this.switchResultsTab(r)})}),e.addEventListener("click",a=>{a.target===e&&this.hideResults()}),document.addEventListener("keydown",a=>{a.key==="Escape"&&!e.classList.contains("hidden")&&this.hideResults()})}startNewGame(e){this.gameLogic=new u(e),this.startTime=Date.now(),this.elapsedTime=0,this.eraserMode=!1,this.startTimer(),this.showScreen("game"),this.renderGameGrid(),this.updateGameInfo(),this.updateAssistButtons(),this.soundManager.playGameStart(),this.notifications.show(`Started new game in ${e} mode`,"info")}renderGameGrid(){const e=this.screens.game.querySelector("#gameGrid");e.innerHTML="";const t=this.gameLogic.getGameState();t.grid.forEach((s,i)=>{const a=document.createElement("div");a.className="grid-cell",a.dataset.index=i,s===null?(a.classList.add("grid-cell--empty"),a.textContent=""):(a.textContent=s,a.addEventListener("click",()=>{this.eraserMode?this.handleEraserClick(i):this.handleCellClick(i)})),t.selectedCells.includes(i)&&a.classList.add("grid-cell--selected"),this.eraserMode&&s!==null&&a.classList.add("grid-cell--erasable"),e.appendChild(a)}),this.eraserMode?e.classList.add("game-screen__grid--eraser-mode"):e.classList.remove("game-screen__grid--eraser-mode")}handleCellClick(e){if(!this.gameLogic)return;const t=this.gameLogic.selectCell(e);t.type==="select"?(this.soundManager.playSelect(),this.renderGameGrid()):t.type==="deselect"?(this.soundManager.playDeselect(),this.renderGameGrid()):t.type==="reset"?this.renderGameGrid():t.type==="valid"?(this.soundManager.playValidPair(),this.renderGameGrid(),this.updateGameInfo(),this.updateAssistButtons(),this.showPairSuccess(t.points),this.gameLogic.checkWinCondition()?this.winGame():this.gameLogic.checkLoseCondition()&&this.loseGame()):t.type==="invalid"&&(this.soundManager.playInvalidPair(),this.renderGameGrid(),this.showPairError(),setTimeout(()=>{this.gameLogic.selectedCells=[],this.renderGameGrid(),this.gameLogic.checkLoseCondition()&&this.loseGame()},1e3))}handleEraserClick(e){!this.gameLogic||!this.eraserMode||(this.gameLogic.erase(e)?(this.soundManager.playAssistUse(),this.renderGameGrid(),this.updateAssistButtons(),this.notifications.show("Number erased","success"),this.gameLogic.getAssistInfo().eraser.available||this.deactivateEraserMode()):(this.notifications.show("Eraser limit reached","warning"),this.deactivateEraserMode()))}updateGameInfo(){if(!this.gameLogic)return;const e=this.screens.game.querySelector("#currentScore"),t=this.screens.game.querySelector("#currentMode");e.textContent=this.gameLogic.score,t.textContent=this.gameLogic.mode.charAt(0).toUpperCase()+this.gameLogic.mode.slice(1),this.updateProgressBar();const s=Math.ceil(this.gameLogic.grid.length/this.gameLogic.gridColumns);if(s>=45){const n=this.gameLogic.maxRows-s;n<=5&&this.notifications.show(`Warning: Only ${n} lines left before grid limit!`,"warning",3e3)}const i=this.gameLogic.hasValidPairs(),a=this.gameLogic.hasAvailableAssists();!i&&!a?(this.notifications.show("Warning: No valid moves left and no assists available! Game will end.","warning",3e3),setTimeout(()=>{this.gameLogic.checkLoseCondition()&&this.loseGame()},100)):!i&&a&&this.notifications.show("No valid moves left! Use your remaining assists.","info",3e3)}updateAssistButtons(){if(!this.gameLogic)return;const e=this.gameLogic.getAssistInfo();Object.keys(e).forEach(s=>{const i=document.getElementById(`${s}Button`),a=document.getElementById(`${s}Counter`),n=e[s];i&&a&&(n.limit===1/0?a.textContent="∞":(a.textContent=n.limit-n.used,n.limit-n.used<=2?(a.style.color="#ff6b6b",a.style.fontWeight="bold"):(a.style.color="",a.style.fontWeight="")),i.disabled=!n.available,i.disabled?i.classList.add("assist-button--disabled"):i.classList.remove("assist-button--disabled"))});const t=document.getElementById("eraserButton");t&&(this.eraserMode?t.classList.add("assist-button--active"):t.classList.remove("assist-button--active"))}useAssist(e){if(!this.gameLogic)return;if(!this.gameLogic.getAssistInfo()[e].available&&e!=="eraser"){this.notifications.show(`${e} is not available!`,"warning");return}switch(e){case"hints":this.useHints();break;case"revert":this.useRevert();break;case"addNumbers":this.useAddNumbers();break;case"shuffle":this.useShuffle();break;case"eraser":this.toggleEraserMode();break;default:this.notifications.show(`Unknown assist: ${e}`,"error")}}useHints(){const e=this.gameLogic.countValidMoves();let t=e.toString();e>5&&(t="5+"),this.gameLogic.assistUses.hints++,this.soundManager.playAssistUse(),this.notifications.show(`Available moves: ${t}`,"info"),this.updateAssistButtons()}useRevert(){this.gameLogic.revert()?(this.soundManager.playAssistUse(),this.renderGameGrid(),this.updateGameInfo(),this.updateAssistButtons(),this.notifications.show("Last move reverted","success")):this.notifications.show("No moves to revert","warning")}useAddNumbers(){if(this.gameLogic.assistUses.addNumbers>=this.gameLogic.assistLimits.addNumbers){this.notifications.show("Add Numbers limit reached","warning");return}if(this.willAddNumbersExceedLimit()){this.loseGame();return}this.gameLogic.addNumbers()?(this.soundManager.playAssistUse(),this.renderGameGrid(),this.updateAssistButtons(),this.notifications.show("Numbers added to grid","success"),this.gameLogic.checkWinCondition()?this.winGame():this.gameLogic.checkLoseCondition()&&this.loseGame()):this.notifications.show("Cannot add numbers at this time","warning")}willAddNumbersExceedLimit(){if(!this.gameLogic)return!1;const e=this.gameLogic.grid.length,t=this.gameLogic.gridColumns,s=this.gameLogic.maxRows,i=s*t-e;let a=0;switch(this.gameLogic.mode){case"classic":a=Math.min(9,i);break;case"random":a=Math.min(9,i);break;case"chaotic":{const o=this.gameLogic.grid.filter(h=>h!==null).length;a=Math.min(o,i);break}}if(a<=0)return!1;const n=e+a;return Math.ceil(n/t)>=s}useShuffle(){this.gameLogic.shuffle()?(this.soundManager.playAssistUse(),this.renderGameGrid(),this.updateAssistButtons(),this.notifications.show("Grid shuffled","success")):this.notifications.show("Shuffle limit reached","warning")}toggleEraserMode(){this.eraserMode?this.deactivateEraserMode():this.activateEraserMode()}activateEraserMode(){if(!this.gameLogic.getAssistInfo().eraser.available){this.notifications.show("Eraser limit reached","warning");return}this.eraserMode=!0,this.renderGameGrid(),this.updateAssistButtons(),this.notifications.show("Click on any number to erase it. Click Eraser button again to cancel.","info",5e3)}deactivateEraserMode(){this.eraserMode=!1,this.renderGameGrid(),this.updateAssistButtons()}showPairSuccess(e){this.notifications.show(`Valid pair. +${e} points`,"success")}showPairError(){this.notifications.show("Invalid pair. Try again.","error")}startTimer(){this.stopTimer(),this.timer=setInterval(()=>{this.elapsedTime=Date.now()-this.startTime,this.updateTimer()},1e3)}stopTimer(){this.timer&&(clearInterval(this.timer),this.timer=null)}updateTimer(){const e=this.screens.game.querySelector("#gameTimer"),t=Math.floor(this.elapsedTime/6e4),s=Math.floor(this.elapsedTime%6e4/1e3);e.textContent=`${t.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}winGame(){this.stopTimer();const e=this.screens.game.querySelector("#gameTimer").textContent;this.saveGameResult(!0,e),localStorage.removeItem("pairEmUpSavedGame"),this.checkSavedGame(),this.soundManager.playWin(),this.notifications.show(`Congratulations! You won with ${this.gameLogic.score} points in ${e}!`,"success",5e3),setTimeout(()=>{this.returnToMenu()},3e3)}loseGame(){this.stopTimer();const e=this.screens.game.querySelector("#gameTimer").textContent;this.saveGameResult(!1,e);let t="Game over ";this.gameLogic.checkGridLimit()?t+="Grid limit (50 lines) reached.":t+="No valid moves available and all assists used.",localStorage.removeItem("pairEmUpSavedGame"),this.checkSavedGame(),this.soundManager.playLose(),this.notifications.show(t,"error",5e3),setTimeout(()=>{this.returnToMenu()},3e3)}checkSavedGame(){var s;const e=localStorage.getItem("pairEmUpSavedGame"),t=(s=this.screens.start)==null?void 0:s.querySelector("#continueButton");if(e&&t)try{const i=JSON.parse(e);if(i.logic&&i.logic.grid){t.disabled=!1;return}}catch{this.notifications.show("Invalid saved game found","warn")}t&&(t.disabled=!0)}continueGame(){const e=localStorage.getItem("pairEmUpSavedGame");if(e)try{const t=JSON.parse(e);this.loadSavedGame(t)}catch{this.notifications.show("Error loading saved game","error"),localStorage.removeItem("pairEmUpSavedGame"),this.checkSavedGame()}}loadSavedGame(e){if(!e||!e.logic){this.notifications.show("No valid saved game found","error");return}try{this.gameLogic=new u(e.logic.mode,e.logic),this.startTime=Date.now()-(e.elapsedTime||0),this.elapsedTime=e.elapsedTime||0,this.eraserMode=e.eraserMode||!1,this.startTimer(),this.showScreen("game"),this.renderGameGrid(),this.updateGameInfo(),this.updateAssistButtons(),setTimeout(()=>{this.gameLogic.checkWinCondition()?this.winGame():this.gameLogic.checkLoseCondition()&&this.loseGame()},100),this.soundManager.playGameStart(),this.notifications.show("Saved game loaded successfully","success")}catch{this.notifications.show("Error loading game state","error")}}autoSaveGame(){this.gameLogic&&this.settings.autoSave&&this.saveGame(!1)}showSettings(){this.populateSettingsForm(),this.showModal("settings")}hideSettings(){this.hideModal("settings")}showResults(){this.renderResultsContent(),this.showModal("results")}hideResults(){this.hideModal("results")}populateSettingsForm(){const e=document.getElementById("themeSelect"),t=document.getElementById("soundToggle"),s=document.getElementById("autoSaveToggle");e&&(e.value=this.settings.theme),t&&(t.checked=this.settings.sound),s&&(s.checked=this.settings.autoSave)}saveSettings(){const e=document.getElementById("themeSelect"),t=document.getElementById("soundToggle"),s=document.getElementById("autoSaveToggle");this.settings.theme=e.value,this.settings.sound=t.checked,this.settings.autoSave=s.checked,localStorage.setItem("pairEmUpSettings",JSON.stringify(this.settings)),this.applySettings(),this.hideSettings(),this.notifications.show("Settings saved successfully","success")}switchResultsTab(e){this.currentResultsTab=e,document.querySelectorAll(".results-screen__tab").forEach(s=>{s.dataset.tab===e?s.classList.add("results-screen__tab--active"):s.classList.remove("results-screen__tab--active")}),this.renderResultsContent()}renderResultsContent(){const e=document.getElementById("resultsContent");if(this.gameResults.length===0){e.innerHTML=`
        <div class="results-screen__no-results">
          No game results yet. Play some games to see your results here.
        </div>
      `;return}let t=[...this.gameResults].slice(-5);this.currentResultsTab==="best"?t.sort((i,a)=>a.score!==i.score?a.score-i.score:this.timeToSeconds(i.time)-this.timeToSeconds(a.time)):t=t.sort((i,a)=>this.timeToSeconds(i.time)-this.timeToSeconds(a.time));const s=`
      <table class="results-screen__table">
        <thead>
          <tr>
            <th class="results-screen__table-header">Mode</th>
            <th class="results-screen__table-header">Result</th>
            <th class="results-screen__table-header">Score</th>
            <th class="results-screen__table-header">Time</th>
            <th class="results-screen__table-header">Date</th>
          </tr>
        </thead>
        <tbody>
          ${t.map(i=>`
            <tr>
              <td class="results-screen__table-cell">${i.mode}</td>
              <td class="results-screen__table-cell">
                ${i.won?'<span class="results-screen__win-indicator">WIN</span>':'<span class="results-screen__loss-indicator">LOSS</span>'}
              </td>
              <td class="results-screen__table-cell">${i.score}</td>
              <td class="results-screen__table-cell">${i.time}</td>
              <td class="results-screen__table-cell">${this.formatDate(i.date)}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `;e.innerHTML=s}timeToSeconds(e){const[t,s]=e.split(":").map(Number);return t*60+s}formatDate(e){const t=new Date(e);return t.toLocaleDateString()+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}saveGameResult(e,t){const s={mode:this.gameLogic.mode,won:e,score:this.gameLogic.score,time:t,date:new Date().toISOString()};this.gameResults.push(s),this.gameResults.length>5&&(this.gameResults=this.gameResults.slice(-5)),this.saveGameResults()}loadGameResults(){const e=localStorage.getItem("pairEmUpGameResults");e?(this.gameResults=JSON.parse(e),this.gameResults.length>5&&(this.gameResults=this.gameResults.slice(-5),this.saveGameResults())):this.gameResults=[]}saveGameResults(){localStorage.setItem("pairEmUpGameResults",JSON.stringify(this.gameResults))}clearGameResults(){this.gameResults.length>0?(this.gameResults=[],this.saveGameResults(),this.renderResultsContent(),this.notifications.show("Game results cleared","success")):this.notifications.show("No game results to clear","info")}resetGame(){if(this.gameLogic&&this.gameLogic.score>0){this.deactivateEraserMode();const e=this.gameLogic.mode;localStorage.removeItem("pairEmUpSavedGame"),this.checkSavedGame(),this.startNewGame(e)}else if(this.deactivateEraserMode(),this.gameLogic){const e=this.gameLogic.mode;this.startNewGame(e)}}saveGame(e=!0){if(this.gameLogic){const t={logic:this.gameLogic.getGameState(),elapsedTime:this.elapsedTime,startTime:this.startTime,eraserMode:this.eraserMode,timestamp:new Date().toISOString()};try{localStorage.setItem("pairEmUpSavedGame",JSON.stringify(t)),e&&this.notifications.show("Game saved successfully","success"),this.checkSavedGame()}catch{e&&this.notifications.show("Error saving game","error")}}}returnToMenu(){this.stopTimer(),this.deactivateEraserMode(),this.showScreen("start"),this.checkSavedGame()}loadSettings(){const e=localStorage.getItem("pairEmUpSettings");e?this.settings=JSON.parse(e):this.settings={sound:!0,theme:"light",autoSave:!0},this.applySettings()}applySettings(){this.settings.theme==="dark"?document.body.classList.add("dark-theme"):document.body.classList.remove("dark-theme"),this.soundManager.setEnabled(this.settings.sound)}updateProgressBar(){if(!this.gameLogic)return;const e=document.getElementById("progressBar"),s=Math.min(this.gameLogic.score,100);e&&(e.style.width=`${s}%`)}}document.addEventListener("DOMContentLoaded",()=>{new f});
